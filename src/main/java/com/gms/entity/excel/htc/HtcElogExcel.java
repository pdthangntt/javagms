package com.gms.entity.excel.htc;

import com.gms.components.ExcelUtils;
import com.gms.components.PixelUtils;
import com.gms.components.TextUtils;
import com.gms.entity.constant.ReferralSourceEnum;
import com.gms.entity.constant.TestObjectGroupEnum;
import com.gms.entity.db.HtcVisitEntity;
import com.gms.entity.db.ParameterEntity;
import com.gms.entity.excel.BaseView;
import com.gms.entity.excel.IExportExcel;
import com.gms.entity.form.htc.HtcElogForm;
import java.io.ByteArrayOutputStream;
import org.apache.commons.lang.StringUtils;
import org.apache.poi.hssf.util.HSSFColor;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.CellStyle;
import org.apache.poi.ss.usermodel.FillPatternType;
import org.apache.poi.ss.usermodel.Font;
import org.apache.poi.ss.usermodel.HorizontalAlignment;
import org.apache.poi.ss.usermodel.IndexedColors;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.VerticalAlignment;

/**
 *
 * @author pdThang
 */
public class HtcElogExcel extends BaseView implements IExportExcel {

    
    private HtcElogForm form;
    private String extension;

    public HtcElogExcel(HtcElogForm form, String extension) {
        setUseStyle(false);
        this.form = form;
        this.extension = extension;
        this.sheetName = "Sheet 1";
    }

    @Override
    public byte[] run() throws Exception {
        workbook = ExcelUtils.getWorkbook(getFileName());
        ByteArrayOutputStream out = new ByteArrayOutputStream();

        createSheet(sheetName);
        createHeader();
        createTable();

        workbook.write(out);
        return out.toByteArray();
    }

    @Override
    public String getFileName() {
        return String.format("%s.%s", form.getFileName(), extension);
    }

    /**
     * Táº¡o header cho excel
     *
     * @throws Exception
     */
    private void createHeader() throws Exception {
        Sheet currentSheet = getCurrentSheet();
        int i = 0;
        currentSheet.setColumnWidth(i, PixelUtils.pixel2WidthUnits(150));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(190));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(300));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));
        currentSheet.setColumnWidth(i += 1, PixelUtils.pixel2WidthUnits(500));

        Row row = createRow();
        setMerge(1, 1, 0, 3, false);
        Cell cell = row.createCell(0);
        cell.setCellValue(form.getTitle().toUpperCase());
        setBold(cell);
        setFont(cell, (short) 18, true, false, new Byte("0"));
        row.setHeight(PixelUtils.pixel2WidthUnits(30));
        cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
        cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

        row = createRow();
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        setMerge(2, 2, 0, 3, false);
        cell = row.createCell(0);
        cell.setCellValue(String.format("TÃªn cÆ¡ sá»: %s", form.getSiteName().toUpperCase()));
        setFont(cell, fontSize, false, true, Font.U_NONE);
        cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
        cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

        row = createRow();
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        setMerge(3, 3, 0, 3, false);
        cell = row.createCell(0);
        cell.setCellValue((StringUtils.isEmpty(form.getSearch().getAdvisoryeTimeFrom()) || StringUtils.isEmpty(form.getSearch().getAdvisoryeTimeTo())) ? form.getAdvisoryeTime() : form.getSearch().getAdvisoryeTimeFrom().equals(form.getSearch().getAdvisoryeTimeTo()) ? String.format("NgÃ y tÆ° váº¥n: %s", form.getSearch().getAdvisoryeTimeFrom()) : String.format("NgÃ y tÆ° váº¥n tá»« %s Äáº¿n %s", form.getSearch().getAdvisoryeTimeFrom(), form.getSearch().getAdvisoryeTimeTo()));
        setFont(cell, (short) 12, false, true, new Byte("0"));
        cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
        cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

        row = createRow();
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        setMerge(4, 4, 0, 3, false);
        cell = row.createCell(0);
        cell.setCellValue(String.format("MÃ£ cÆ¡ sá»: %s", form.getSiteCode().toUpperCase()));
        setFont(cell, fontSize, false, true, Font.U_NONE);
        cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
        cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

        row = createRow();
        setMerge(5, 5, 0, 3, false);
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        cell = row.createCell(0);
        cell.setCellValue(!"".equals(form.getSearch().getService()) && form.getSearch().getService() != null ? String.format("Dá»ch vá»¥: %s", "CD".equals(form.getSearch().getService()) ? "CÄ" : form.getSearch().getService()) : "");
        setFont(cell, fontSize, false, true, Font.U_NONE);
        cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
        cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);
    }

    /**
     * Táº¡o báº£ng trong excel
     */
    private void createTable() {

        int i = 0;

        //DÃ²ng Äáº§u tiÃªn Äá» tráº¯ng
        Row row = createRow();
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        //DÃ²ng Äáº§u tiÃªn Äá» tráº¯ng
        row = createRow();
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        Cell cell;

        Font font = workbook.createFont();
        font.setFontHeightInPoints(fontSize);
        font.setFontName(fontName);
        font.setBold(true);

        CellStyle th = workbook.createCellStyle();
        th.setWrapText(true);
        th.setFillForegroundColor(IndexedColors.BLACK.getIndex());
        th.setFillPattern(FillPatternType.SOLID_FOREGROUND);
        th.setAlignment(HorizontalAlignment.LEFT);
        th.setVerticalAlignment(VerticalAlignment.CENTER);
        font.setColor(HSSFColor.HSSFColorPredefined.WHITE.getIndex());
        th.setFont(font);

        //TiÃªu Äá»
        row = createRow();
        row.setHeight(PixelUtils.pixel2WidthUnits(13));
        cell = createCell(row, i);
        cell.setCellValue("TT");
        cell.setCellStyle(th);
        setBorders(cell);

        cell = createCell(row, i += 1);
        cell.setCellValue("A3. MÃ£ cÆ¡ sá» ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A4. Sá» thá»© tá»± khÃ¡ch hÃ ng");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A2. Loáº¡i dá»ch vá»¥");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A2.1 Má»¥c ÄÃ­ch khÃ¡ch hÃ ng Äáº¿n cÆ¡ sá» cá» Äá»nh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A3.1 NhÃ¢n viÃªn dá»ch vá»¥ khÃ´ng chuyÃªn");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A5. TÃªn khÃ¡ch hÃ ng");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A6. Sá» Äiá»n thoáº¡i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A7. Sá» chá»©ng minh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A8. DÃ¢n tá»c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A9. Giá»i tÃ­nh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A10. NÄm sinh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A11.4  Äá»a chá» thÆ°á»ng trÃº");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A11.3 PhÆ°á»ng /xÃ£");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A11.2 Quáº­n /Huyá»n");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A11.1 Tá»nh/ThÃ nh phá»");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A12.4. Äá»a chá» táº¡m trÃº");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A12.3 PhÆ°á»ng / XÃ£");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A12.2 Quáº­n / Huyá»n");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A12.1 Tá»nh / ThÃ nh phá»");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A13. Nghá» nghiá»p");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.1 Nghiá»n chÃ­ch ma tÃºy (NCMT)");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue(" A14.2 NgÆ°á»i bÃ¡n dÃ¢m (PNBD)");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.3 Phá»¥ ná»¯ mang thai");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.4 NgÆ°á»i hiáº¿n mÃ¡u");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.5 Bá»nh nhÃ¢n lao");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.6 NgÆ°á»i máº¯c nhiá»m trÃ¹ng lÃ¢y truyá»n qua ÄÆ°á»ng TD");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.7 Thanh niÃªn khÃ¡m tuyá»n nghÄ©a vá»¥ quÃ¢n sá»±	");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.8 Nam quan há» tÃ¬nh dá»¥c vá»i nam (MSM)");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.9 NgÆ°á»i chuyá»n giá»i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.10 Vá»£/chá»ng/ban tÃ¬nh cá»§a ngÆ°á»i nhiá»m HIV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.11 Vá»£/chá»ng/ban tÃ¬nh cá»§a ngÆ°á»i NCC");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.12Bá»nh nhÃ¢n nghi ngá» AIDS");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A14.13 CÃ¡c Äá»i tÆ°á»£ng khÃ¡c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A15.1 TiÃªm chÃ­ch ma tÃºy");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A15.2 Quan há» tÃ¬nh dá»¥c vá»i ngÆ°á»i mua/bÃ¡n dÃ¢m");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A15.3 Quan há» tÃ¬nh dá»¥c Äá»ng giá»i nam");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A15.4 Quan há» vá»i nhiá»u ngÆ°á»i (ko vÃ¬ tiá»m & ma tÃºy)");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A15.5 Nguy cÆ¡ khÃ¡c cá»§a báº£n thÃ¢n");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.1 Tiáº¿p cáº­n cá»ng Äá»ng");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.2 KÃªnh xÃ©t nghiá»m theo dáº¥u báº¡n tÃ¬nh/báº¡n chÃ­ch");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.3 CÃ¡n Bá» y táº¿");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.4 Máº¡ng xÃ£ há»i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.5 KhÃ¡c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("NguyÃªn nhÃ¢n khÃ¡ch hÃ ng biáº¿t Äáº¿n dá»ch vá»¥(CÅ©, ko dÃ¹ng ná»¯a)");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.1. MÃ£ sá» cá»§a tiáº¿p cáº­n cá»ng Äá»ng:");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A17.2 MÃ£ sá» theo dáº¥u báº¡n tÃ¬nh/báº¡n chÃ­ch");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("A1. NgÃ y láº¥y mÃ¡u xÃ©t nghiá»m sÃ ng lá»c	");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("B. XÃ©t nghiá»m sÃ ng lá»c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("B1.Káº¿t quáº£ xÃ©t nghiá»m sÃ ng lá»c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("B1.1 Chá»n khi káº¿t quáº£ XN lÃ  cÃ³ pháº£n á»©ng ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("(B1.2+C7) . NgÃ y khÃ¡ch hÃ ng nháº­n káº¿t quáº£ xÃ©t nghiá»m ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("B2. KhÃ¡ch hÃ ng Äá»ng Ã½ tiáº¿p tá»¥c XN táº¡i cÆ¡ sá» y táº¿ ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("B2.1. TÃªn cÆ¡ sá»  XN sÃ ng lá»c	");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C1. TÃªn cÆ¡ sá» xÃ©t nghiá»m kháº³ng Äá»nh HIV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C2. MÃ£ xÃ©t nghiá»m kháº³ng Äá»nh do cÆ¡ sá» TVXN cá» Äá»nh cáº¥p");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C2. 1. Loáº¡i hÃ¬nh xÃ©t nghiá»m kháº³ng Äá»nh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C3. Káº¿t quáº£ xÃ©t nghiá»m kháº³ng Äá»nh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C3a. Káº¿t quáº£ xÃ©t nghiá»m nhanh nhiá»m má»i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C4a. ÄÆ°á»ng lÃ¢y truyá»n HIV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C4b. Loáº¡i xÃ©t nghiá»m PCR HIV bá» sung	");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C4b. Káº¿t quáº£ xÃ©t nghiá»m PCR HIV :");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C5.  NgÃ y xÃ©t nghiá»m kháº³ng Äá»nh ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C6. NgÃ y cÆ¡ sá» nháº­n káº¿t quáº£ xÃ©t nghiá»m kháº³ng Äá»nh");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C8. Káº¿t quáº£ xÃ©t nghiá»m táº£i lÆ°á»£ng virus");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("C8b. Káº¿t quáº£ xÃ©t nghiá»m táº£i lÆ°á»£ng virus");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("ChÄm sÃ³c Äiá»u trá» HIV/AIDS");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Äiá»u trá» cÃ¡c bá»nh LNQÄTD");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Äiá»u trá» Lao");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Dá»± phÃ²ng lÃ¢y truyá»n máº¹ con");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("KHHGÄ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("ChÄm sÃ³c y táº¿ khÃ¡c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("ChÄm sÃ³c y táº¿ khÃ¡c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Tiáº¿p cáº­n cá»ng Äá»ng");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("NhÃ³m há» trá»£");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Cai nghiá»n cá»ng Äá»ng	TÆ° váº¥n giáº£m nguy cÆ¡ bá» sung");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Láº¥y mÃ¡u xÃ©t nghiá»m kháº³ng Äá»nh HIV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("KhÃ¡c");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("KhÃ´ng chuyá»n gá»­i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Ghi chÃº");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D1. NgÃ y thá»±c hiá»n tÆ° váº¥n chuyá»n gá»­i Äiá»u trá» ARV:");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D1a. Káº¿t quáº£ tÆ° váº¥n chuyá»n gá»­i Äiá»u trá» ARV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D1.1 NgÃ y chuyá»n gá»­i Äiá»u trá» ARV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D1.2. Káº¿t quáº£ tÆ° váº¥n cung cáº¥p thÃ´ng tin thá»±c hiá»n xÃ©t nghiá»m theo dáº¥u báº¡n tÃ¬nh/báº¡n chÃ­ch ");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D2. TÃªn cÆ¡ sá» Äiá»u trá» mÃ  khÃ¡ch hÃ ng ÄÆ°á»£c chuyá»n gá»­i tá»i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D2. MÃ£ cÆ¡ sá» Äiá»u trá» mÃ  khÃ¡ch hÃ ng ÄÆ°á»£c chuyá»n gá»­i tá»i");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D2.1 Tá»nh/ThÃ nh phá» chuyá»n Äáº¿n");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D2.2 Huyá»n chuyá»n Äáº¿n");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D3. NgÃ y ÄÄng kÃ½ Äiá»u trá» ARV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D4. TÃªn cÆ¡ sá» mÃ  khÃ¡ch hÃ nh ÄÃ£ ÄÄng kÃ½ Äiá»u trá»");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D4. MÃ£ cÆ¡ sá» mÃ  khÃ¡ch hÃ ng ÄÃ£ ÄÄng kÃ½ Äiá»u trá»");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D4.1 Tá»nh/ThÃ nh phá» Äiá»u trá»");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D4.2 Huyá»n Äiá»u trá»");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("D5. MÃ£ sá» Äiá»u trá» HIV");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("TÆ° váº¥n viÃªn 01");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("TÆ° váº¥n viÃªn 02");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("Booking ID");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("GUID");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("UPDATE Status");
        cell.setCellStyle(th);

        cell = createCell(row, i += 1);
        cell.setCellValue("updateTime");
        cell.setCellStyle(th);

        // loop to create row content
        int index = 0;

        if (form.getItems().size() > 0) {

            for (HtcVisitEntity item : form.getItems()) {
                int indexRow = 0;
                // Sá» thá»© tá»±
                row = createRow();
                cell = createCell(row, indexRow);

                cell.setCellValue(index += 1);
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(form.getSiteCode().toUpperCase());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getCode()) ? "" : item.getCode().toUpperCase());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getServiceID()) ? "" : "CD".equals(item.getServiceID()) ? "CÄ" : item.getServiceID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPatientName()) ? "" : item.getPatientName().toUpperCase());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPatientPhone()) ? "" : item.getPatientPhone());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPatientID()) ? "" : item.getPatientID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getRaceID()) ? "" : form.getOptions().get("race").get(item.getRaceID()));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getGenderID()) ? "3" : item.getGenderID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getYearOfBirth()) ? "" : item.getYearOfBirth());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPermanentAddress()) ? "" : item.getPermanentAddress());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPermanentWardID()) ? "" : form.getWards().get(item.getPermanentWardID()));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPermanentDistrictID()) ? "" : form.getLocations().get("districts").getOrDefault(item.getPermanentDistrictID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPermanentProvinceID()) ? "" : form.getLocations().get("provinces").getOrDefault(item.getPermanentProvinceID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getCurrentAddress()) ? "" : item.getCurrentAddress());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getCurrentWardID()) ? "" : form.getWards().get(item.getCurrentWardID()));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getCurrentDistrictID()) ? "" : form.getLocations().get("districts").getOrDefault(item.getCurrentDistrictID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getCurrentProvinceID()) ? "" : form.getLocations().get("provinces").getOrDefault(item.getCurrentProvinceID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getJobID()) ? "" : form.getOptions().get("job").get(item.getJobID()));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.NGHIEN_TRICH_MA_TUY.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.PHU_NU_BAN_DAM.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.PREGNANT_WOMEN.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.NGUOI_BAN_MAU_HIENMAU_CHOMAU.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.LAO.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.BENH_NHAN_MAC_CAC_NHIEM_TRUNG_LTQDTD.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.THANH_NIEM_KHAM_NGHIA_VU_QUAN_SU.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.MSM.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.NGUOI_CHUYEN_GIOI.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.VO_CHONG_BANTINH_NGUOI_NHIEM_HIV.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.VO_CHONG_BANTINH_NGUOI_NGUY_CO_CAO.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue("");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getObjectGroupID()) ? "" : TestObjectGroupEnum.KHAC.getKey().equals(item.getObjectGroupID()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                if (item.getRiskBehaviorID().isEmpty()) {
                    cell.setCellValue("");
                } else {
                    for (String string : item.getRiskBehaviorID()) {
                        if ("1".equals(string)) {
                            cell.setCellValue("1");
                            break;
                        }
                        cell.setCellValue("");
                    }
                }
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                if (item.getRiskBehaviorID().isEmpty()) {
                    cell.setCellValue("");
                } else {
                    for (String string : item.getRiskBehaviorID()) {
                        if ("2".equals(string)) {
                            cell.setCellValue("1");
                            break;
                        }
                        cell.setCellValue("");
                    }
                }
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                if (item.getRiskBehaviorID().isEmpty()) {
                    cell.setCellValue("");
                } else {
                    for (String string : item.getRiskBehaviorID()) {
                        if ("3".equals(string)) {
                            cell.setCellValue("1");
                            break;
                        }
                        cell.setCellValue("");
                    }
                }
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                if (item.getRiskBehaviorID().isEmpty()) {
                    cell.setCellValue("");
                } else {
                    for (String string : item.getRiskBehaviorID()) {
                        if ("4".equals(string)) {
                            cell.setCellValue("1");
                            break;
                        }
                        cell.setCellValue("");
                    }
                }
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                if (item.getRiskBehaviorID().isEmpty()) {
                    cell.setCellValue("");
                } else {
                    for (String string : item.getRiskBehaviorID()) {
                        if ("5".equals(string)) {
                            cell.setCellValue("1");
                            break;
                        }
                        cell.setCellValue("");
                    }
                }
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getReferralSource() == null || item.getReferralSource().isEmpty() ? "" :  item.getReferralSource().contains(ReferralSourceEnum.TC_CONG_DONG.getKey()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getReferralSource() == null || item.getReferralSource().isEmpty() ? "" : item.getReferralSource().contains(ReferralSourceEnum.KENH_BTBC.getKey()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getReferralSource() == null || item.getReferralSource().isEmpty() ? "" : item.getReferralSource().contains(ReferralSourceEnum.CAN_BO_YTE.getKey()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getReferralSource() == null || item.getReferralSource().isEmpty() ? "" : item.getReferralSource().contains(ReferralSourceEnum.INTERNET.getKey()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getReferralSource() == null || item.getReferralSource().isEmpty() ? "" : item.getReferralSource().contains(ReferralSourceEnum.KHAC.getKey()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getApproacherNo()) ? "" : item.getApproacherNo().toUpperCase());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getAdvisoryeTime() == null ? "" : TextUtils.formatDate(item.getAdvisoryeTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getIsAgreePreTest()) ? "" : item.getIsAgreePreTest());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getTestResultsID()) ? "" : item.getTestResultsID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getResultsTime() == null ? "" : TextUtils.formatDate(item.getResultsTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getIsAgreeTest() == null ? "" : item.getIsAgreeTest() == true ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(form.getSiteName());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getSiteConfirmTest()) ? "" : form.getConfirmSite().get(item.getSiteConfirmTest()));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getConfirmTestNo()) ? "" : item.getConfirmTestNo());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getConfirmResultsID()) ? "" : item.getConfirmResultsID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getEarlyHiv()) ? "" : item.getEarlyHiv());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getModeOfTransmission()) ? "" : ("1".equals(item.getModeOfTransmission()) || "2".equals(item.getModeOfTransmission()) || "3".equals(item.getModeOfTransmission()) || "4".equals(item.getModeOfTransmission())) ? item.getModeOfTransmission() : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getConfirmTime() == null ? "" : TextUtils.formatDate(item.getConfirmTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getResultsSiteTime() == null ? "" : TextUtils.formatDate(item.getResultsSiteTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getVirusLoad()) ? "" : item.getVirusLoad());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getExchangeConsultTime() == null ? "" : TextUtils.formatDate(item.getExchangeConsultTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getArvExchangeResult()) ? "" : "1".equals(item.getArvExchangeResult()) ? "1" : "");
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getExchangeTime() == null ? "" : TextUtils.formatDate(item.getExchangeTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getPartnerProvideResult()) ? "" : item.getPartnerProvideResult());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getArrivalSite()) ? "" : item.getArrivalSite());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getExchangeProvinceID()) ? "" : form.getLocations().get("provinces").getOrDefault(item.getExchangeProvinceID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getExchangeDistrictID()) ? "" : form.getLocations().get("districts").getOrDefault(item.getExchangeDistrictID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getRegisterTherapyTime() == null ? "" : TextUtils.formatDate(item.getRegisterTherapyTime(), "dd/MM/yyyy"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getRegisteredTherapySite()) ? "" : item.getRegisteredTherapySite());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getTherapyRegistProvinceID()) ? "" : form.getLocations().get("provinces").getOrDefault(item.getTherapyRegistProvinceID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getTherapyRegistDistrictID()) ? "" : form.getLocations().get("districts").getOrDefault(item.getTherapyRegistDistrictID(), " "));
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getTherapyNo()) ? "" : item.getTherapyNo());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getStaffBeforeTestID()) ? "" : item.getStaffBeforeTestID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(StringUtils.isEmpty(item.getStaffAfterID()) ? "" : item.getStaffAfterID());
                cell.getCellStyle().setAlignment(HorizontalAlignment.LEFT);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell = createCell(row, indexRow += 1);

                cell.setCellValue(item.getUpdateAt() == null ? "" : TextUtils.formatDate(item.getUpdateAt(), "dd/MM/yyyy hh:mm:ss"));
                cell.getCellStyle().setAlignment(HorizontalAlignment.CENTER);
                cell.getCellStyle().setVerticalAlignment(VerticalAlignment.CENTER);
            }
        }

    }

}
